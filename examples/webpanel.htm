<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  
  <style>
    body {
      background-color: #f8f8f8;
    }
    .ts-row-0 {
      padding-top: 10px;
    }
    .ts-row-1 {
      padding-bottom: 10px;
    }
    .ts-row-2 {
      padding-top: 10px;
      padding-bottom: 10px;
    }
    .ts-btn-90 {
      width: 90px;
    }
    .ts-btn-full {
      width: 100%;
    }
  </style>
  
</head>
<body>

  <div class="container">
    <div class="row text-center ts-row-0">
      <div class="col-xs-4">
        <button type="button" id="menu-jog" class="btn btn-warning navbar-btn ts-btn-full ts-menu">JOG</button>
      </div>
      <div class="col-xs-4">
        <button type="button" id="menu-cart" class="btn btn-primary navbar-btn ts-btn-full ts-menu">CART</button>
      </div>
      <div class="col-xs-4">
        <button type="button" id="menu-set" class="btn btn-success navbar-btn ts-btn-full ts-menu">SET</button>
      </div>
    </div>
  </div>

  <div class="container">  
    <div class="row">
      <div class="col-xs-12 text-center">
        <h4 class="well well-sm" id="status">load...</h4>
      </div>
    </div>    
  </div>
  
  <div id="jog" class="container">

    <div class="row text-center ts-row-1">
      <div class="col-xs-4">
        <button type="button" id="j1m" class="btn btn-warning ts-btn-90">J1-</button>
      </div>
      <div class="col-xs-4">
        <h4 class="j1">load...</h4>
      </div>
      <div class="col-xs-4">
        <button type="button" id="j1p" class="btn btn-warning ts-btn-90">J1+</button>
      </div>
    </div>

    <div class="row text-center ts-row-2">
      <div class="col-xs-4">
        <button type="button" id="j2m" class="btn btn-warning ts-btn-90">J2-</button>
      </div>
      <div class="col-xs-4">
        <h4 class="j2">load...</h4>
      </div>
      <div class="col-xs-4">
        <button type="button" id="j2p" class="btn btn-warning ts-btn-90">J2+</button>
      </div>
    </div>

    <div class="row text-center ts-row-2">
      <div class="col-xs-4">
        <button type="button" id="j3m" class="btn btn-warning ts-btn-90">J3-</button>
      </div>
      <div class="col-xs-4">
        <h4 class="j3">load...</h4>
      </div>
      <div class="col-xs-4">
        <button type="button" id="j3p" class="btn btn-warning ts-btn-90">J3+</button>
      </div>
    </div>

    <div class="row text-center ts-row-2">
      <div class="col-xs-4">
        <button type="button" id="j4m" class="btn btn-warning ts-btn-90">J4-</button>
      </div>
      <div class="col-xs-4">
        <h4 class="j4">load...</h4>
      </div>
      <div class="col-xs-4">
        <button type="button" id="j4p" class="btn btn-warning ts-btn-90">J4+</button>
      </div>
    </div>

    <div class="row text-center ts-row-2">
      <div class="col-xs-4">
        <button type="button" id="j5m" class="btn btn-warning ts-btn-90">J5-</button>
      </div>
      <div class="col-xs-4">
        <h4 class="j5">load...</h4>
      </div>
      <div class="col-xs-4">
        <button type="button" id="j5p" class="btn btn-warning ts-btn-90">J5+</button>
      </div>
    </div>

    <div class="row text-center ts-row-2">
      <div class="col-xs-4">
        <button type="button" id="j6m" class="btn btn-warning ts-btn-90">J6-</button>
      </div>
      <div class="col-xs-4">
        <h4 class="j6">load...</h4>
      </div>
      <div class="col-xs-4">
        <button type="button" id="j6p" class="btn btn-warning ts-btn-90">J6+</button>
      </div>
    </div>

  </div>

  <div id="cart" class="container">

    <div class="row text-center ts-row-1">
      <div class="col-xs-4">
        <button type="button" id="wmx" class="btn btn-primary ts-btn-90">X-</button>
      </div>
      <div class="col-xs-4">
        <h4 class="wx">load...</h4>
      </div>
      <div class="col-xs-4">
        <button type="button" id="wpx" class="btn btn-primary ts-btn-90">X+</button>
      </div>
    </div>

    <div class="row text-center ts-row-2">
      <div class="col-xs-4">
        <button type="button" id="wmy" class="btn btn-primary ts-btn-90">Y-</button>
      </div>
      <div class="col-xs-4">
        <h4 class="wy">load...</h4>
      </div>
      <div class="col-xs-4">
        <button type="button" id="wpy" class="btn btn-primary ts-btn-90">Y+</button>
      </div>
    </div>

    <div class="row text-center ts-row-2">
      <div class="col-xs-4">
        <button type="button" id="wmz" class="btn btn-primary ts-btn-90">Z-</button>
      </div>
      <div class="col-xs-4">
        <h4 class="wz">load...</h4>
      </div>
      <div class="col-xs-4">
        <button type="button" id="wpz" class="btn btn-primary ts-btn-90">Z+</button>
      </div>
    </div>

    <div class="row text-center ts-row-2">
      <div class="col-xs-4">
        <button type="button" id="wmw" class="btn btn-primary ts-btn-90">W-</button>
      </div>
      <div class="col-xs-4">
        <h4 class="ww">load...</h4>
      </div>
      <div class="col-xs-4">
        <button type="button" id="wpw" class="btn btn-primary ts-btn-90">W+</button>
      </div>
    </div>

    <div class="row text-center ts-row-2">
      <div class="col-xs-4">
        <button type="button" id="wmp" class="btn btn-primary ts-btn-90">P-</button>
      </div>
      <div class="col-xs-4">
        <h4 class="wp">load...</h4>
      </div>
      <div class="col-xs-4">
        <button type="button" id="wpp" class="btn btn-primary ts-btn-90">P+</button>
      </div>
    </div>

    <div class="row text-center ts-row-2">
      <div class="col-xs-4">
        <button type="button" id="wmr" class="btn btn-primary ts-btn-90">R-</button>
      </div>
      <div class="col-xs-4">
        <h4 class="wr">load...</h4>
      </div>
      <div class="col-xs-4">
        <button type="button" id="wpr" class="btn btn-primary ts-btn-90">R+</button>
      </div>
    </div>

  </div>

  <div id="set" class="container">

    <div class="row text-center">
      <div class="col-xs-4">
        <h4 id="xMax">Load...</h4>
      </div>
      <div class="col-xs-4">
        <h4 id="yMax">Load...</h4>
      </div>
      <div class="col-xs-4">
        <h4 id="zMax">Load...</h4>
      </div>
    </div>

    <div class="row text-center ts-row-1">
      <div class="col-xs-4">
        <button type="button" id="xMaxCh" class="btn btn-default ts-btn-90" data-toggle="modal" data-target="#xMaxSet">X max</button>
      </div>
      <div class="col-xs-4">
        <button type="button" id="yMaxCh" class="btn btn-default ts-btn-90" data-toggle="modal" data-target="#yMaxSet">Y max</button>
      </div>
      <div class="col-xs-4">
        <button type="button" id="zMaxCh" class="btn btn-default ts-btn-90" data-toggle="modal" data-target="#zMaxSet">Z max</button>
      </div>
    </div>

    <div class="row text-center ts-row-1"></div>

    <div class="row text-center">
      <div class="col-xs-4">
        <h4 id="xMin">Load...</h4>
      </div>
      <div class="col-xs-4">
        <h4 id="yMin">Load...</h4>
      </div>
      <div class="col-xs-4">
        <h4 id="zMin">Load...</h4>
      </div> 
    </div>

    <div class="row text-center ts-row-1">
      <div class="col-xs-4">
        <button type="button" id="xMinCh" class="btn btn-default ts-btn-90" data-toggle="modal" data-target="#xMinSet">X min</button>
      </div>
      <div class="col-xs-4">
        <button type="button" id="yMinCh" class="btn btn-default ts-btn-90" data-toggle="modal" data-target="#yMinSet">Y min</button>
      </div>
      <div class="col-xs-4">
        <button type="button" id="zMinCh" class="btn btn-default ts-btn-90" data-toggle="modal" data-target="#zMinSet">Z min</button>
      </div>
    </div>

    <div class="row text-center ts-row-2"></div>

    <div class="row text-center ts-row-2">
      <div class="col-xs-4">
        <button type="button" id="pickup" class="btn btn-success ts-btn-90">Pickup</button>
      </div>
      <div class="col-xs-4">
        <button type="button" id="zero" class="btn btn-success ts-btn-90">Zero</button>
      </div>
      <div class="col-xs-4">
        <button type="button" id="place" class="btn btn-success ts-btn-90">Place</button>
      </div>
    </div>

    <div class="row text-center ts-row-2"></div>

    <div class="row text-center ts-row-2">
      <div class="col-xs-4">
        <button type="button" id="coord" class="btn btn-success ts-btn-90">Coord</button>
      </div>
      <div class="col-xs-8" id="runTask">
        <select class="form-control" id="selectTask"></select>
      </div>
    </div>

    <div class="row text-center ts-row-2"></div>

  </div>

  <div class="container">
    <div class="row text-center ts-row-1">
      <div class="col-xs-4">
        <button type="button" id="reset" class="btn navbar-btn ts-btn-full">Reset</button>
      </div>
      <div class="col-xs-4">
        <button type="button" id="abort" class="btn btn-danger navbar-btn ts-btn-full">Abort</button>
      </div>    
      <div class="col-xs-4">
        <button type="button" id="start" class="btn btn-info navbar-btn ts-btn-full">Start</button>
      </div>    
    </div>
  </div>

  <footer class="text-center">
    <small>&copy; Copyright 2017, &#211;buda University - <a href="http://irob.uni-obuda.hu">iROB</a></small>
  </footer>

  <!-- Modals -->

  <div id="xMaxSet" class="modal fade" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Enter the new value</h4>
          <span>(from -9999 to 9999)<span>
        </div>
        <div class="modal-body">
          <p>If you leave it empty the axis limit is maximized</p>
          <h4>X max: <input type="number" id="xMaxNew" min="-9999" max="9999"></h4>
          <p class="limitWarning" style="color:red">The limit is need to be between -9999 and 9999</p>
          <p class="limitSuccess" style="color:green">Saved!</p>
        </div>
        <div class="modal-footer">
          <button type="button" id="xMaxSave" class="btn btn-default">Save</button>
          <button type="button" class="btn btn-default limit-cancel" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <div id="yMaxSet" class="modal fade" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Enter the new value</h4>
          <span>(from -9999 to 9999)<span>
        </div>
        <div class="modal-body">
          <p>If you leave it empty the axis limit is maximized</p>
          <h4>Y max: <input type="number" id="yMaxNew" min="-9999" max="9999"></h4>
          <p class="limitWarning" style="color:red">The limit is need to be between -9999 and 9999</p>
          <p class="limitSuccess" style="color:green">Saved!</p>
        </div>
        <div class="modal-footer">
          <button type="button" id="yMaxSave" class="btn btn-default">Save</button>
          <button type="button" class="btn btn-default limit-cancel" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <div id="zMaxSet" class="modal fade" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Enter the new value</h4>
          <span>(from -9999 to 9999)<span>
        </div>
        <div class="modal-body">
          <p>If you leave it empty the axis limit is maximized</p>
          <h4>Z max: <input type="number" id="zMaxNew" min="-9999" max="9999"></h4>
          <p class="limitWarning" style="color:red">The limit is need to be between -9999 and 9999</p>
          <p class="limitSuccess" style="color:green">Saved!</p>
        </div>
        <div class="modal-footer">
          <button type="button" id="zMaxSave" class="btn btn-default">Save</button>
          <button type="button" class="btn btn-default limit-cancel" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <div id="xMinSet" class="modal fade" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Enter the new value</h4>
          <span>(from -9999 to 9999)<span>
        </div>
        <div class="modal-body">
          <p>If you leave it empty the axis limit is maximized</p>
          <h4>X min: <input type="number" id="xMinNew" min="-9999" max="9999"></h4>
          <p class="limitWarning" style="color:red">The limit is need to be between -9999 and 9999</p>
          <p class="limitSuccess" style="color:green">Saved!</p>
        </div>
        <div class="modal-footer">
          <button type="button" id="xMinSave" class="btn btn-default">Save</button>
          <button type="button" class="btn btn-default limit-cancel" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <div id="yMinSet" class="modal fade" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Enter the new value</h4>
          <span>(from -9999 to 9999)<span>
        </div>
        <div class="modal-body">
          <p>If you leave it empty the axis limit is maximized</p>
          <h4>Y min: <input type="number" id="yMinNew" min="-9999" max="9999"></h4>
          <p class="limitWarning" style="color:red">The limit is need to be between -9999 and 9999</p>
          <p class="limitSuccess" style="color:green">Saved!</p>
        </div>
        <div class="modal-footer">
          <button type="button" id="yMinSave" class="btn btn-default">Save</button>
          <button type="button" class="btn btn-default limit-cancel" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <div id="zMinSet" class="modal fade" role="dialog">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">Enter the new value</h4>
          <span>(from -9999 to 9999)<span>
        </div>
        <div class="modal-body">
          <p>If you leave it empty the axis limit is maximized</p>
          <h4>Z min: <input type="number" id="zMinNew" min="-9999" max="9999"></h4>
          <p class="limitWarning" style="color:red">The limit is need to be between -9999 and 9999</p>
          <p class="limitSuccess" style="color:green">Saved!</p>
        </div>
        <div class="modal-footer">
          <button type="button" id="zMinSave" class="btn btn-default">Save</button>
          <button type="button" class="btn btn-default limit-cancel" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <script>

    $(document).ready(function() {  

      var refresh
      var setInt = 50
      var enButVar
      var setTime = 1000
      var axisLimit = 9999
    
      $('#jog').show()
      $('#cart').hide()
      $('#set').hide()
      $('#reset').hide()
      $('#start').hide()
      $('.limitWarning').hide()
      $('.limitSuccess').hide()

      $('#menu-jog').click(function() {
        $('#jog').show()
        $('#cart').hide()
        $('#set').hide()
        $('#reset').hide()
        $('#start').hide()
      })     

      $('#menu-cart').click(function() {
        $('#jog').hide()
        $('#cart').show()
        $('#set').hide()
        $('#reset').hide()
        $('#start').hide()
      })

      $('#menu-set').click(function() {
        $('#jog').hide()
        $('#cart').hide()
        $('#set').show()
        $('#reset').show()
        $('#start').show()
      })

      $.getJSON("/KAREL/webmonitor", function(data) {    

        var removeItem = '######'
        
        progList = jQuery.grep(data.progs, function(value) {
          return value != removeItem;
        });
        
        for(var i=2; i< progList.length;i++) {
          //creates option tag and appends to select if parent div has id dropdown
          jQuery('<option/>', {value: progList[i], html: progList[i]}).appendTo('#runTask select');
        }

      })
      
      $('#selectTask option:contains("WEBMOTION TP")').prop('selected',true);
      
      getposj()

      function getposj () {
        $.getJSON("/KAREL/webmonitor", function(data) {
        
          for (i = 0; i <= 5; i++) {
            if (data.joint[i] == 100000) { 
              $('.j' + (i+1)).html('N/A')
              $('#j' + (i+1) + 'p').prop("disabled", true)
              $('#j' + (i+1) + 'm').prop("disabled", true)
            } else {
              $('.j' + (i+1)).html(Math.round(data.joint[i]) + '&#176;')
            }
          }

          $('.wx').html(Math.round(data.pose[0]) + ' mm')
          $('.wy').html(Math.round(data.pose[1]) + ' mm')
          $('.wz').html(Math.round(data.pose[2]) + ' mm')
          $('.ww').html(Math.round(data.pose[3]) + '&#176;')
          $('.wp').html(Math.round(data.pose[4]) + '&#176;')
          $('.wr').html(Math.round(data.pose[5]) + '&#176;')

          if ( data.limit[0] >= 10000 || data.limit[0] <= -10000 ) {
            $('#xMax').html('max')
          } else {
            $('#xMax').html(data.limit[0]) + ' mm'
          }
          if ( data.limit[1] >= 10000 || data.limit[1] <= -10000 ) {
            $('#yMax').html('max')
          } else {
            $('#yMax').html(data.limit[1]) + ' mm'
          }
          if ( data.limit[2] >= 10000 || data.limit[2] <= -10000 ) {
            $('#zMax').html('max')
          } else {
            $('#zMax').html(data.limit[2]) + ' mm'
          }
          if ( data.limit[3] >= 10000 || data.limit[3] <= -10000 ) {
            $('#xMin').html('min')
          } else {
            $('#xMin').html(data.limit[3]) + ' mm'
          }
          if ( data.limit[4] >= 10000 || data.limit[4] <= -10000 ) {
            $('#yMin').html('min')
          } else {
            $('#yMin').html(data.limit[4]) + ' mm'
          }
          if ( data.limit[5] >= 10000 || data.limit[5] <= -10000 ) {
            $('#zMin').html('min')
          } else {
            $('#zMin').html(data.limit[5]) + ' mm'
          }

          if (data.error[0] == 0) {
            if (data.status[0] == 1) {
              $('#status').html("Webmotion is running")
              $('#status').css("color", "#5cb85c")
              if (data.status[1] == 1) {
                $('#status').html("Position not reachable")
              }
              if (data.status[4] == 3) {
                $('#status').html("Z max limit STOP")
              }
              if (data.status[4] == 6) {
                $('#status').html("Z min limit STOP")
              }
              if (data.status[3] == 3) {
                $('#status').html("Y max limit STOP")
              }
              if (data.status[3] == 6) {
                $('#status').html("Y min limit STOP")
              }
              if (data.status[2] == 3) {
                $('#status').html("X max limit STOP")
              }
              if (data.status[2] == 6) {
                $('#status').html("X min limit STOP")
              }
            } else {
              $('#status').html("Standby")
              $('#status').css("color", "#428bca")
            }
          } else {
            $('#status').html(data.error[1])
            $('#status').css("color", "#d9534f")
          }

          $('#xMaxCh').click(function() {
            $('.limitWarning').hide()
            $('.limitSuccess').hide()
            if ( data.limit[0] >= 10000 || data.limit[0] <= -10000 ) {
              $("#xMaxNew").val('')
            } else {
              $("#xMaxNew").val(data.limit[0])
            }
          })
 
          $('#yMaxCh').click(function() {
            $('.limitWarning').hide()
            $('.limitSuccess').hide()
            if ( data.limit[1] >= 10000 || data.limit[1] <= -10000 ) {
              $("#yMaxNew").val('')
            } else {
              $("#yMaxNew").val(data.limit[1])
            }
          })
 
          $('#zMaxCh').click(function() {
            $('.limitWarning').hide()
            $('.limitSuccess').hide()
            if ( data.limit[2] >= 10000 || data.limit[2] <= -10000 ) {
              $("#zMaxNew").val('')
            } else {
              $("#zMaxNew").val(data.limit[2])
            }
          })

          $('#xMinCh').click(function() {
            $('.limitWarning').hide()
            $('.limitSuccess').hide()
            if ( data.limit[3] >= 10000 || data.limit[3] <= -10000 ) {
              $("#xMinNew").val('')
            } else {
              $("#xMinNew").val(data.limit[3])
            }
          })

          $('#yMinCh').click(function() {
            $('.limitWarning').hide()
            $('.limitSuccess').hide()
            if ( data.limit[4] >= 10000 || data.limit[4] <= -10000 ) {
              $("#yMinNew").val('')
            } else {
              $("#yMinNew").val(data.limit[4])
            }
          })

          $('#zMinCh').click(function() {
            $('.limitWarning').hide()
            $('.limitSuccess').hide()
            if ( data.limit[5] >= 10000 || data.limit[5] <= -10000 ) {
              $("#zMinNew").val('')
            } else {
              $("#zMinNew").val(data.limit[5])
            }
          })

          setTimeout(getposj(), 333)
        })
      }

      // Start motion

      $('#start').click(function() {
        var sendTask = $('#runTask :selected').text()
        console.log('Start motion')
        console.log('cica: ' + sendTask )
        $.ajax({
          type: 'GET',
          url: '/KAREL/webstart?gettask=' + sendTask,
          cache: false,
          success: function() {
            console.log('Send START is successful')
          }
        })
      })

      // Reset the controller

      $('#reset').click(function() {
        console.log('Reset the controller')
        $.ajax({
          type: 'GET',
          url: '/KAREL/webreset',
          cache: false,
          success: function() {
            console.log('Send RESET is successful')
          }
        })
      })

      // Abort motion

      $('#abort').click(function() {
        console.log('ABORT motion')
        $.ajax({
          type: 'GET',
          url: '/KAREL/webabort',
          cache: false,
          success: function() {
            console.log('Send ABORT is successful')
          }
        })
      })

      // Keep motion
      
      function webkeep() {
        console.log('KEEP motion')
        $.ajax({
          type: 'GET',
          url: '/KAREL/webkeep',
          cache: false,
          success: function() {
            console.log('Send KEEP is successful')
          }
        })  
      }

      // Stop motion
      
      function webstop() {
        console.log('STOP(99) motion')
        $.ajax({
          type: 'GET',
          url: '/KAREL/webstop',
          cache: false,
          success: function() {
            console.log('Send STOP(99) is successful')
          }
        })
      }

      // Enable buttons after motion
      
      function enBut() {
        $(".btn").removeAttr("disabled")
      }
    
      // Jogging

      $('#j1m').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=j&getcpos=1&getstep=-1',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      })

      $('#j1p').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=j&getcpos=1&getstep=1',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      })

      $('#j2m').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=j&getcpos=2&getstep=-1',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      }) 

      $('#j2p').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=j&getcpos=2&getstep=1',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      }) 

      $('#j3m').on('mousedown touchstart', function() {
        clearTimeout(enButVar)      
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=j&getcpos=3&getstep=-1',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      }) 

      $('#j3p').on('mousedown touchstart', function() {
        clearTimeout(enButVar)      
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=j&getcpos=3&getstep=1',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      })  

      $('#j4m').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false) 
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=j&getcpos=4&getstep=-1',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      }) 

      $('#j4p').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=j&getcpos=4&getstep=1',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      }) 

      $('#j5m').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=j&getcpos=5&getstep=-1',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      }) 

      $('#j5p').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=j&getcpos=5&getstep=1',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      }) 

      $('#j6m').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)  
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=j&getcpos=6&getstep=-1',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      }) 

      $('#j6p').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false) 
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=j&getcpos=6&getstep=1',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      }) 

      // Move to linear
      
      $('#wmx').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=l&getcpos=1&getstep=-3',
          cache: false,
          success: function() {
            console.log('')
          }
        })
        refresh = setInterval(webkeep, setInt)
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      })

      $('#wpx').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=l&getcpos=1&getstep=3',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      })

      $('#wmy').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=l&getcpos=2&getstep=-3',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)  
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      })

      $('#wpy').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=l&getcpos=2&getstep=3',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      })

      $('#wmz').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=l&getcpos=3&getstep=-3',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)  
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      })

      $('#wpz').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=l&getcpos=3&getstep=3',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)  
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      })

      // Rotate the TCP

      $('#wmw').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=r&getcpos=4&getstep=-1',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)  
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      })

      $('#wpw').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=r&getcpos=4&getstep=1',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)  
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      })

      $('#wmp').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=r&getcpos=5&getstep=-1',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)  
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      })

      $('#wpp').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=r&getcpos=5&getstep=1',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)  
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      })

      $('#wmr').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=r&getcpos=6&getstep=-1',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)  
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      })

      $('#wpr').on('mousedown touchstart', function() {
        clearTimeout(enButVar)
        $(".btn").not(this).prop("disabled", true)
        $("#abort").prop("disabled", false)
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=r&getcpos=6&getstep=1',
          cache: false,
          success: function() {}
        })
        refresh = setInterval(webkeep, setInt)  
      }).on('mouseup touchend', function() {
        webstop()
        clearInterval(refresh)
        enButVar = setTimeout(enBut, setTime)
      })

      //Set limits
      
      $('#xMaxSave').click(function() {
        if ( $("#xMaxNew").val() > axisLimit || $("#xMaxNew").val() < -axisLimit) {
          $('.limitSuccess').hide()
          $('.limitWarning').show()
        } else {
          $('.limitWarning').hide()
          $.ajax({
            type: 'GET',
            url: '/KAREL/weblimit?getlimit_id=1&getlimit_val=' + $("#xMaxNew").val(),
            cache: false,
            success: function() {
              $('.limitSuccess').show()
            }
          })
        }
      })

      $('#yMaxSave').click(function() {
        if ( $("#yMaxNew").val() > axisLimit || $("#yMaxNew").val() < -axisLimit) {
          $('.limitSuccess').hide()
          $('.limitWarning').show()
        } else {
          $('.limitWarning').hide()
          $.ajax({
            type: 'GET',
            url: '/KAREL/weblimit?getlimit_id=2&getlimit_val=' + $("#yMaxNew").val(),
            cache: false,
            success: function() {
              $('.limitSuccess').show()
            }
          })
        }
      })

      $('#zMaxSave').click(function() {
        if ( $("#zMaxNew").val() > axisLimit || $("#zMaxNew").val() < -axisLimit) {
          $('.limitSuccess').hide()
          $('.limitWarning').show()
        } else {
          $('.limitWarning').hide()
          $.ajax({
            type: 'GET',
            url: '/KAREL/weblimit?getlimit_id=3&getlimit_val=' + $("#zMaxNew").val(),
            cache: false,
            success: function() {
              $('.limitSuccess').show()
            }
          })
        }
      })

      $('#xMinSave').click(function() {
        if ( $("#xMinNew").val() > axisLimit || $("#xMinNew").val() < -axisLimit) {
          $('.limitSuccess').hide()
          $('.limitWarning').show()
        } else {
          $('.limitWarning').hide()
          $.ajax({
            type: 'GET',
            url: '/KAREL/weblimit?getlimit_id=4&getlimit_val=' + $("#xMinNew").val(),
            cache: false,
            success: function() {
              $('.limitSuccess').show()
            }
          })
        }
      })

      $('#yMinSave').click(function() {
        if ( $("#yMinNew").val() > axisLimit || $("#yMinNew").val() < -axisLimit) {
          $('.limitSuccess').hide()
          $('.limitWarning').show()
        } else {
          $('.limitWarning').hide()
          $.ajax({
            type: 'GET',
            url: '/KAREL/weblimit?getlimit_id=5&getlimit_val=' + $("#yMinNew").val(),
            cache: false,
            success: function() {
              $('.limitSuccess').show()
            }
          })
        }
      })

      $('#zMinSave').click(function() {
        if ( $("#yMinNew").val() > axisLimit || $("#yMinNew").val() < -axisLimit) {
          $('.limitSuccess').hide()
          $('.limitWarning').show()
        } else {
          $('.limitWarning').hide()
          $.ajax({
            type: 'GET',
            url: '/KAREL/weblimit?getlimit_id=6&getlimit_val=' + $("#zMinNew").val(),
            cache: false,
            success: function() {
              $('.limitSuccess').show()
            }
          })
        }
      })

      //Move to predefined pose
      
      $('#pickup').click(function() {
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=p&j1=-45&j2=45&j3=90&j4=0&j5=0&j6=0',
          cache: false,
          success: function() {}
        })
      })

      $('#zero').click(function() {
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=p&j1=0&j2=0&j3=0&j4=0&j5=0&j6=0',
          cache: false,
          success: function() {}
        })
      })

      $('#place').click(function() {
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=p&j1=0&j2=45&j3=135&j4=0&j5=-45&j6=0',
          cache: false,
          success: function() {}
        })
      })

      $('#coord').click(function() {
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=p&j1=0&j2=30&j3=90&j4=0&j5=-90&j6=0',
          cache: false,
          success: function() {}
        })
      })

      $('#show').click(function() {
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=p&j1=90&j2=0&j3=90&j4=0&j5=-90&j6=-90',
          cache: false,
          success: function() {}
        })
      })

      $('#touch').click(function() {
        $.ajax({
          type: 'GET',
          url: '/KAREL/webcontrol?getstart=p&j1=90&j2=60&j3=30&j4=0&j5=60&j6=-90',
          cache: false,
          success: function() {}
        })
      })

    })

  </script>

</body>
</html>